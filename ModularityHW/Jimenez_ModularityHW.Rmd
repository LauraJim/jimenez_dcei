---
title: "Jimenez_ModularityHW"
author: "Laura Jiménez"
date: "March 2018"
output: html_document
#bibliography: ModularityHW_refs.bib
#csl: Science.csl
---

```{r setup, include=F}
knitr::opts_chunk$set(echo = F,include=F)
```

<!---```{r check, echo=F}
library(checkpoint)
checkpoint("2018-02-12")
```-->

```{r Funmtime}
mtime <- function(files)
{
  lapply(Sys.glob(files),function(x) {X = file.info(x)$mtime})
}
```

## Abstract

# Introduction
Use first research question as main idea:
1) Can we see climate warming for ourselves by analysing these data?
An important aspect in climate change research is the study of change weather and climate extremes...
Here we analyze the spatial and temporal characteristics of change in annual mean temperature and precipitation across the United States along the period 1950-2010...
# Methods

## Data
-
```{r data, cache=T,cache.extra=list(mtime(c("USAAnnualTemp1950_2008.rds","USAAnnualPcpn1950_2008.rds"))}
# Check if you really need to use the mtime function or try to use cache.extra in a different way, see class March 6

# provided == T, if the data are stored in the same directory as .rds files, and ==F, if the data will be downloaded from a website
provided <- T
files <- c("USAAnnualTemp1950_2008.rds","USAAnnualPcpn1950_2008.rds")
if(provided==T)
{
  temp <- readRDS(files[1])
  prec <- readRDS(files[2])
}
# both files should be data.frame objects
str(temp)
str(prec)
```

## Models and R functions?

```{r cleaning}
# follow steps 1-3 in the HW guide
nyear <- length(unique(temp$year))
# Filtering data by weather station name and removing NA's
filter1 <- aggregate(data~name,temp,length,na.action = na.omit)
# Removing the weather stations with less than "minY" years of data
minY <- 40
filter2 <- subset(filter1,filter1$data >= minY)$name
# Select only the stations in filter2
filter3 <- subset(temp,subset=temp$name%in%filter2,selec=c(lon,lat,data,year))
mclean <- matrix(as.vector(filter3$data),nrow=nyear)
mclean[1:8,1:8]
```

Figure X shows the locations if the n1 temperature and n2 precipitation stations used in this study. Remember that we got rid of the stations with less than 40 years of data.
```{r mapData}
# showing the temp and prec trends in each location (maps package)
library(maps)
# map of the USA with state divisions
map('state', fill = F)
# extract the unique coordinate pairs from filter3 to plot the stations
sts <- cbind(filter3$lon[nrow(mclean)*(1:ncol(mclean))],filter3$lat[nrow(mclean)*(1:ncol(mclean))])
# show location of stations
points(sts,pch=19,col=orange)
# now color the points according to the temp or prec measurements

```

# Results
Answer the research questions:
2) In what parts of the country are temperatures getting warmer? Are there any parts that actually got colder over 1905-2010?
3) Can we say, based on these data, that a change in precipitation has occurred over this period?

# Discussion

# References